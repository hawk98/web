<HTML>	
<HEAD>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<TITLE>page</TITLE><script language="javascript">if (window == top) top.location.href = "/index.html";
 </script>
<link href="css/display_web.css" rel="stylesheet" type="text/css" />


<script language="javascript" src="js/InputCheck_web.js"></script>

<script language="javascript">

var portNum = $%portNum#$;

var psMode0 = new Array();
psMode0[1] = "$%psMode1(0)#$";
psMode0[2] = "$%psMode2(0)#$";
psMode0[3] = "$%psMode3(0)#$";
psMode0[4] = "$%psMode4(0)#$";
psMode0[5] = "$%psMode5(0)#$";
psMode0[6] = "$%psMode6(0)#$";
psMode0[7] = "$%psMode7(0)#$";
psMode0[8] = "$%psMode8(0)#$";
psMode0[9] = "$%psMode9(0)#$";
psMode0[10] = "$%psMode10(0)#$";
psMode0[11] = "$%psMode11(0)#$";
psMode0[12] = "$%psMode12(0)#$";
psMode0[13] = "$%psMode13(0)#$";
psMode0[14] = "$%psMode14(0)#$";
psMode0[15] = "$%psMode15(0)#$";
psMode0[16] = "$%psMode16(0)#$";
psMode0[17] = "$%psMode17(0)#$";
psMode0[18] = "$%psMode18(0)#$";
psMode0[19] = "$%psMode19(0)#$";
psMode0[20] = "$%psMode20(0)#$";
psMode0[21] = "$%psMode21(0)#$";
psMode0[22] = "$%psMode22(0)#$";
psMode0[23] = "$%psMode23(0)#$";
psMode0[24] = "$%psMode24(0)#$";
psMode0[25] = "$%psMode25(0)#$";
psMode0[26] = "$%psMode26(0)#$";
psMode0[27] = "$%psMode27(0)#$";
psMode0[28] = "$%psMode28(0)#$";

var psMode1 = new Array();
psMode1[1] = "$%psMode1(1)#$";
psMode1[2] = "$%psMode2(1)#$";
psMode1[3] = "$%psMode3(1)#$";
psMode1[4] = "$%psMode4(1)#$";
psMode1[5] = "$%psMode5(1)#$";
psMode1[6] = "$%psMode6(1)#$";
psMode1[7] = "$%psMode7(1)#$";
psMode1[8] = "$%psMode8(1)#$";
psMode1[9] = "$%psMode9(1)#$";
psMode1[10] = "$%psMode10(1)#$";
psMode1[11] = "$%psMode11(1)#$";
psMode1[12] = "$%psMode12(1)#$";
psMode1[13] = "$%psMode13(1)#$";
psMode1[14] = "$%psMode14(1)#$";
psMode1[15] = "$%psMode15(1)#$";
psMode1[16] = "$%psMode16(1)#$";
psMode1[17] = "$%psMode17(1)#$";
psMode1[18] = "$%psMode18(1)#$";
psMode1[19] = "$%psMode19(1)#$";
psMode1[20] = "$%psMode20(1)#$";
psMode1[21] = "$%psMode21(1)#$";
psMode1[22] = "$%psMode22(1)#$";
psMode1[23] = "$%psMode23(1)#$";
psMode1[24] = "$%psMode24(1)#$";
psMode1[25] = "$%psMode25(1)#$";
psMode1[26] = "$%psMode26(1)#$";
psMode1[27] = "$%psMode27(1)#$";
psMode1[28] = "$%psMode28(1)#$";

var psMode2 = new Array();
psMode2[1] = "$%psMode1(2)#$";
psMode2[2] = "$%psMode2(2)#$";
psMode2[3] = "$%psMode3(2)#$";
psMode2[4] = "$%psMode4(2)#$";
psMode2[5] = "$%psMode5(2)#$";
psMode2[6] = "$%psMode6(2)#$";
psMode2[7] = "$%psMode7(2)#$";
psMode2[8] = "$%psMode8(2)#$";
psMode2[9] = "$%psMode9(2)#$";
psMode2[10] = "$%psMode10(2)#$";
psMode2[11] = "$%psMode11(2)#$";
psMode2[12] = "$%psMode12(2)#$";
psMode2[13] = "$%psMode13(2)#$";
psMode2[14] = "$%psMode14(2)#$";
psMode2[15] = "$%psMode15(2)#$";
psMode2[16] = "$%psMode16(2)#$";
psMode2[17] = "$%psMode17(2)#$";
psMode2[18] = "$%psMode18(2)#$";
psMode2[19] = "$%psMode19(2)#$";
psMode2[20] = "$%psMode20(2)#$";
psMode2[21] = "$%psMode21(2)#$";
psMode2[22] = "$%psMode22(2)#$";
psMode2[23] = "$%psMode23(2)#$";
psMode2[24] = "$%psMode24(2)#$";
psMode2[25] = "$%psMode25(2)#$";
psMode2[26] = "$%psMode26(2)#$";
psMode2[27] = "$%psMode27(2)#$";
psMode2[28] = "$%psMode28(2)#$";

var psLimit = new Array();
psLimit[1] = "$%psLimit1#$";
psLimit[2] = "$%psLimit2#$";
psLimit[3] = "$%psLimit3#$";
psLimit[4] = "$%psLimit4#$";
psLimit[5] = "$%psLimit5#$";
psLimit[6] = "$%psLimit6#$";
psLimit[7] = "$%psLimit7#$";
psLimit[8] = "$%psLimit8#$";
psLimit[9] = "$%psLimit9#$";
psLimit[10] = "$%psLimit10#$";
psLimit[11] = "$%psLimit11#$";
psLimit[12] = "$%psLimit12#$";
psLimit[13] = "$%psLimit13#$";
psLimit[14] = "$%psLimit14#$";
psLimit[15] = "$%psLimit15#$";
psLimit[16] = "$%psLimit16#$";
psLimit[17] = "$%psLimit17#$";
psLimit[18] = "$%psLimit18#$";
psLimit[19] = "$%psLimit19#$";
psLimit[20] = "$%psLimit20#$";
psLimit[21] = "$%psLimit21#$";
psLimit[22] = "$%psLimit22#$";
psLimit[23] = "$%psLimit23#$";
psLimit[24] = "$%psLimit24#$";
psLimit[25] = "$%psLimit25#$";
psLimit[26] = "$%psLimit26#$";
psLimit[27] = "$%psLimit27#$";
psLimit[28] = "$%psLimit28#$";

var psMAC = new Array();
psMAC[1] = "$%psMAC1#$";
psMAC[2] = "$%psMAC2#$";
psMAC[3] = "$%psMAC3#$";
psMAC[4] = "$%psMAC4#$";
psMAC[5] = "$%psMAC5#$";
psMAC[6] = "$%psMAC6#$";
psMAC[7] = "$%psMAC7#$";
psMAC[8] = "$%psMAC8#$";
psMAC[9] = "$%psMAC9#$";
psMAC[10] = "$%psMAC10#$";
psMAC[11] = "$%psMAC11#$";
psMAC[12] = "$%psMAC12#$";
psMAC[13] = "$%psMAC13#$";
psMAC[14] = "$%psMAC14#$";
psMAC[15] = "$%psMAC15#$";
psMAC[16] = "$%psMAC16#$";
psMAC[17] = "$%psMAC17#$";
psMAC[18] = "$%psMAC18#$";
psMAC[19] = "$%psMAC19#$";
psMAC[20] = "$%psMAC20#$";
psMAC[21] = "$%psMAC21#$";
psMAC[22] = "$%psMAC22#$";
psMAC[23] = "$%psMAC23#$";
psMAC[24] = "$%psMAC24#$";
psMAC[25] = "$%psMAC25#$";
psMAC[26] = "$%psMAC26#$";
psMAC[27] = "$%psMAC27#$";
psMAC[28] = "$%psMAC28#$";

function psModeChange(i)
{
	  var modeId = "psMode" + i, limitId = "psLimit" + i, MACId = "psMAC" + i;
	  var mo = document.getElementById(modeId);
	  var li = document.getElementById(limitId);
	  var MA = document.getElementById(MACId);
	  
	  if(mo.value == 0){
	  	li.value = "";
//	  	li.className = "disableText";
	    li.disabled = true;
	    MA.value = "";
	    MA.disabled = true;
//	  	MA.className = "disableText";
	  }else if(mo.value == 1){
	    li.disabled = false;
//	  	li.className = "textfield";
	    MA.value = "";
	    MA.disabled = true;
//	  	MA.className = "disableText";
	  }else if(mo.value == 2){
	  	li.value = "";
	    li.disabled = true;
//	  	li.className = "disableText";
	    MA.disabled = false;
//	  	MA.className = "textfield";
	  }
}

function checkMacSame(i, v){
  var modeId,  MACId;
  var mo,  MA;

  for(var j = 1; j <= portNum; j++)
  {
	  modeId = "psMode" + j, MACId = "psMAC" + j;
	  mo = document.getElementById(modeId);
	  MA = document.getElementById(MACId);
    
    if(j == i || mo.value != 2) continue;
    
    if(MA.value == v) return false;
  }  
  
  return true;
}

function submitForm(){
  var idName = "", descVal = "";
  var doc = document.form1;
  var modeId, limitId, MACId;
  var mo, li, MA;
  
  for(var i = 1; i <= portNum; i++)
  {
	  modeId = "psMode" + i, limitId = "psLimit" + i, MACId = "psMAC" + i;
	  mo = document.getElementById(modeId);
	  li = document.getElementById(limitId);
	  MA = document.getElementById(MACId);
	  
	  if(mo.value == 0) continue;
	  if(mo.value == 1)
	  {
	    if(isNaN(li.value) || li.value<1 || li.value>8191 || !fucCheckNUM(li.value))
	    {
	      alert("端口学习数量限制输入错误！");
	      li.focus();
	      return;	
	    }
	  }
	  if(mo.value == 2)
	  {
	  	if(!tdMacCheck(MA.value))
	  	{
	  		alert("MAC 地址输入错误！");
	  		MA.focus();
	  		return;
	  	}
	  	if(!checkMacSame(i, MA.value))
	  	{
	  		alert("一个 MAC 地址不能绑定在两个端口上！");
	  		MA.focus();
	  		return;
	  	}
	  }
  }
  doc.submit();
}

function setCurState()
{
	for(var i=1;i<=portNum;i++)
	{
		psModeChange(i);
	}
}

function display(){
changebgcolor();
}

</script>


</HEAD>

<BODY  onload=display() >
<br>


<div id="view_help"  style="display:none">

<table width="98%" border="0" align="center" cellpadding="0" cellspacing="0" class="">
<tr>
    <td  class="Tablelist"><nobr>帮助</nobr></td>
    <td   class="tablenew"></td>
  </tr>
</table>
<TABLE width="98%" align="center" cellpadding=0 cellspacing=0   class="tablebord" bgcolor="D3E4F4">
	  
<SCRIPT language="javascript">
		document.writeln(top.leftframe.helptext('portsecurity'));
 </SCRIPT>
	  
	  </TABLE>
</div>


  <form id="form1" name="form1" method="post" action="portsecurity.html">

<table width="98%" border="0" align="center" cellpadding="0" cellspacing="0" class="">
  <tr>
    <td  class=Tablelist id=tabs name=tabs>端口安全</td>
  </tr>
</table>

<table width="98%" border="0" align="center" cellpadding=0 cellspacing=0 class="tablebord" id="table1"  >
    <TR align="center" height=22>
      <TD width="18%"   nowrap >端口</TD>
      <TD width="28%"   nowrap >模式</TD>
      <TD width="27%"   nowrap >MAC 学习数量限制(1~8191)</TD>
      <TD width="27%"   nowrap >MAC 绑定</TD>
    </TR>
    
    <script language= "javascript">
	  for(var i = 1; i <= portNum; i++)
	  {	
	  	document.write("<tr class='table_maintable'>");
		document.write("<td align='center'><div align='center'>"+i+"</div></td>");
		document.write("<td class='td25'><select name='psMode"+i+"' id='psMode"+i+"' onChange='psModeChange("+i+");'>");
	  	document.write("<option value='0' "+psMode0[i]+">无限制无绑定</option>");
		document.write("<option value='1' "+psMode1[i]+">限制数量</option>");
		document.write("<option value='2' "+psMode2[i]+">绑定 MAC</option>");
		document.write("</select></td>");
		
		document.write("<td class='td25'><input type='text' name='psLimit"+i+"' id='psLimit"+i+"' size='24' maxlength='4' value='"+psLimit[i]+"'></td>");
		document.write("<td class='td25'><input type='text' name='psMAC"+i+"' id='psMAC"+i+"' size='24' maxlength='17' value='"+psMAC[i]+"'></td>");
		document.write("</tr>");		
	  }
	  </script>
    <tr>
    	<td class="partition" colspan="32">&nbsp;
      <input name="ddddd" type="button" class="button1" id="ddddd"  onclick="submitForm();" value="提交">
    </div></td>
    </tr>
    
<script  language="javascript">
setCurState();
    </script>
  </table>
</form>

 
<a name="bottom"></a></BODY></HTML>




