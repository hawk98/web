<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=gb2312" />
<title>WEB</title>


<script src="JS/check.js" language="javascript"></script>
<script language="javascript">

var portNum = $%portNum#$;

function select_all(flag)
{
	for(i=1;i<=portNum;i++)
	{		
		if(!document.getElementById("lacE"+i).disabled)
		{
			if(flag)
			{
				document.getElementById("lacE"+i).checked = true;		
			}
			else
			{
				document.getElementById("lacE"+i).checked = false;		
			}			
		}
	}
}


function setPortValid()
{
	for(i=1;i<=portNum;i++)
	{		
/*			
		if(CheckPortValid(PortValidInfo, i) == false)
		{
		    document.getElementById("lacE"+i).disabled = true;		
		    document.getElementById("lacK"+i).disabled = true;	
		    document.getElementById("lacR"+i).disabled = true;			    
		}			
*/
	}
}
function checkSub(){
	setKeyValueSub();
	for(var i = 1 ;i <= portNum ;i++)
	{
		var keyName = "lacK";
		var modeName = "lacE";
		if(!fucCheckNUM(document.getElementById(keyName+i).value))
			{
				alert("端口"+i+"的Key错误，只能是数字(范围是1-65535)和“Auto”");
				setKeyValue();
				return;
			}
			
		if((document.getElementById(keyName+i).value < 0 || document.getElementById(keyName+i).value > 65535))
		{
				alert("端口"+i+"的Key错误，只能是数字(范围是1-65535)和“Auto”");
				setKeyValue();
				return;
		}
	}
	
	

/*	
	for(var i=0;i<document.form1.elements.length;i++)
	{
		if("提 交"==document.form1.elements[i].value)
		{
			document.form1.elements[i].disabled = true;
		}
	}
*/

	document.form1.button.disabled = true;

	document.form1.submit();
	
}

function setKeyValueSub()
{
	for(var i = 1 ;i <= portNum ;i++)
	{
		var keyName = "lacK";
		if(document.getElementById(keyName+i).value == "Auto")
			document.getElementById(keyName+i).value = 0;
		
	}
}
function setKeyValue()
{
	for(var i = 1 ;i <= portNum ;i++)
	{
		var keyName = "lacK";
		if(document.getElementById(keyName+i).value == "0")
			document.getElementById(keyName+i).value = "Auto";
		
	}
}


function changestat(str,id)
{
	var checked = 0;
	var valid_port = 0;
		
	for(i=1;i<=portNum;i++)
	{		
		if(!document.getElementById(str+i).disabled)	
		{
			if(document.getElementById(str+i).checked)
			{
				checked = checked + 1;
			}
			valid_port = valid_port + 1;
		}
	}
	
	if(checked == valid_port)
	{
		document.getElementById(id).checked = true ;
	}
	else
	{
		document.getElementById(id).checked = false ; 
	}
}
</script>


</head>

<body  oncontextmenu=self.event.returnValue=false>
<div class="container" id="cpcontainer">
  <form id="form1" name="form1" method="post" action="">
  <tr><td height="10"></td></tr>
  <tr>
    <td colspan="9" align="left"><table width="250" border="0" cellpadding="0" cellspacing="0" class="table_main2">
      <tr>
        <td width="41" background="images/main_top.jpg"><img src="images/main_tops.jpg"/></td>
        <td background="images/main_top.jpg" class="h14blackblod">LACP 配置</td>
      </tr>
    </table></td></tr>
  <tr><td class="table_main1">
  <table class="table_maintable" cellpadding="0">
  <tr>
    <td width="10%" class="partition">端口</td>
    <td width="30%" class="partition">模式
      <input type="checkbox" name="select_ss" id="select_ss" value="checkbox"  onclick="select_all(this.checked)"/>
      全选</td>
    <td width="30%" class="partition">密钥</td>
    <td class="partition">角色</td>
  </tr>
  <tr>
    <td class="crons">1</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE1" id="lacE1" / $%lacE1#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK1" id="lacK1" / VALUE="$%lacK1#$"></td>
    <td class="crons"><select name="lacR1" id="lacR1">
      <option value="1" $%lacR1(1)#$>主动</option>
      <option value="0" $%lacR1(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">2</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE2" id="lacE2" / $%lacE2#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK2" id="lacK2" / VALUE="$%lacK2#$"></td>
    <td class="crons"><select name="lacR2" id="lacR2">
      <option value="1" $%lacR2(1)#$>主动</option>
      <option value="0" $%lacR2(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">3</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE3" id="lacE3" / $%lacE3#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK3" id="lacK3" / VALUE="$%lacK3#$"></td>
    <td class="crons"><select name="lacR3" id="lacR3">
      <option value="1" $%lacR3(1)#$>主动</option>
      <option value="0" $%lacR3(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">4</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE4" id="lacE4" / $%lacE4#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK4" id="lacK4" / VALUE="$%lacK4#$"></td>
    <td class="crons"><select name="lacR4" id="lacR4">
      <option value="1" $%lacR4(1)#$>主动</option>
      <option value="0" $%lacR4(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">5</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE5" id="lacE5" / $%lacE5#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK5" id="lacK5" / VALUE="$%lacK5#$"></td>
    <td class="crons"><select name="lacR5" id="lacR5">
      <option value="1" $%lacR5(1)#$>主动</option>
      <option value="0" $%lacR5(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">6</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE6" id="lacE6" / $%lacE6#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK6" id="lacK6" / VALUE="$%lacK6#$"></td>
    <td class="crons"><select name="lacR6" id="lacR6">
      <option value="1" $%lacR6(1)#$>主动</option>
      <option value="0" $%lacR6(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">7</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE7" id="lacE7" / $%lacE7#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK7" id="lacK7" / VALUE="$%lacK7#$"></td>
    <td class="crons"><select name="lacR7" id="lacR7">
      <option value="1" $%lacR7(1)#$>主动</option>
      <option value="0" $%lacR7(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">8</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE8" id="lacE8" / $%lacE8#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK8" id="lacK8" / VALUE="$%lacK8#$"></td>
    <td class="crons"><select name="lacR8" id="lacR8">
      <option value="1" $%lacR8(1)#$>主动</option>
      <option value="0" $%lacR8(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">9</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE9" id="lacE9" / $%lacE9#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK9" id="lacK9" / VALUE="$%lacK9#$"></td>
    <td class="crons"><select name="lacR9" id="lacR9">
      <option value="1" $%lacR9(1)#$>主动</option>
      <option value="0" $%lacR9(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">10</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE10" id="lacE10" / $%lacE10#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK10" id="lacK10" / VALUE="$%lacK10#$"></td>
    <td class="crons"><select name="lacR10" id="lacR10">
      <option value="1" $%lacR10(1)#$>主动</option>
      <option value="0" $%lacR10(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">11</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE11" id="lacE11" / $%lacE11#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK11" id="lacK11" / VALUE="$%lacK11#$"></td>
    <td class="crons"><select name="lacR11" id="lacR11">
      <option value="1" $%lacR11(1)#$>主动</option>
      <option value="0" $%lacR11(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">12</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE12" id="lacE12" / $%lacE12#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK12" id="lacK12" / VALUE="$%lacK12#$"></td>
    <td class="crons"><select name="lacR12" id="lacR12">
      <option value="1" $%lacR12(1)#$>主动</option>
      <option value="0" $%lacR12(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">13</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE13" id="lacE13" / $%lacE13#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK13" id="lacK13" / VALUE="$%lacK13#$"></td>
    <td class="crons"><select name="lacR13" id="lacR13">
      <option value="1" $%lacR13(1)#$>主动</option>
      <option value="0" $%lacR13(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">14</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE14" id="lacE14" / $%lacE14#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK14" id="lacK14" / VALUE="$%lacK14#$"></td>
    <td class="crons"><select name="lacR14" id="lacR14">
      <option value="1" $%lacR14(1)#$>主动</option>
      <option value="0" $%lacR14(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">15</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE15" id="lacE15" / $%lacE15#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK15" id="lacK15" / VALUE="$%lacK15#$"></td>
    <td class="crons"><select name="lacR15" id="lacR15">
      <option value="1" $%lacR15(1)#$>主动</option>
      <option value="0" $%lacR15(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">16</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE16" id="lacE16" / $%lacE16#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK16" id="lacK16" / VALUE="$%lacK16#$"></td>
    <td class="crons"><select name="lacR16" id="lacR16">
      <option value="1" $%lacR16(1)#$>主动</option>
      <option value="0" $%lacR16(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">17</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE17" id="lacE17" / $%lacE17#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK17" id="lacK17" / VALUE="$%lacK17#$"></td>
    <td class="crons"><select name="lacR17" id="lacR17">
      <option value="1" $%lacR17(1)#$>主动</option>
      <option value="0" $%lacR17(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">18</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE18" id="lacE18" / $%lacE18#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK18" id="lacK18" / VALUE="$%lacK18#$"></td>
    <td class="crons"><select name="lacR18" id="lacR18">
      <option value="1" $%lacR18(1)#$>主动</option>
      <option value="0" $%lacR18(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">19</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE19" id="lacE19" / $%lacE19#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK19" id="lacK19" / VALUE="$%lacK19#$"></td>
    <td class="crons"><select name="lacR19" id="lacR19">
      <option value="1" $%lacR19(1)#$>主动</option>
      <option value="0" $%lacR19(0)#$>被动</option>
    </select></td>
  </tr>
  <tr>
    <td class="crons">20</td>
    <td class="crons"><input type="checkbox" value="ON"  name="lacE20" id="lacE20" / $%lacE20#$ onClick="changestat('lacE','select_ss');">启用</td>
    <td class="crons"><input type="text" name="lacK20" id="lacK20" / VALUE="$%lacK20#$"></td>
    <td class="crons"><select name="lacR20" id="lacR20">
      <option value="1" $%lacR20(1)#$>主动</option>
      <option value="0" $%lacR20(0)#$>被动</option>
    </select></td>
  </tr>
    
 <tr>
    <td colspan="4" align="center" height=40>
      <input type="button" class="button1" name="button" id="button" value="提 交" onclick="checkSub()" />
    </td>
    </tr>
</table>
<script language="javascript">
setKeyValue();
setPortValid();
changestat("lacE","select_ss");
</script>
<INPUT TYPE="HIDDEN" NAME="CheckBoxManager" VALUE="lacE1,lacE2,lacE3,lacE4,lacE5,lacE6,lacE7,lacE8,lacE9,lacE10,lacE11,lacE12,lacE13,lacE14,lacE15,lacE16,lacE17,lacE18,lacE19,lacE20,lacE21,lacE22,lacE23,lacE24,lacE25,lacE26,lacE27,lacE28" >
</form>
</div>
</body>
</html>
